<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador Musical Interactivo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #121212;
            color: #ffffff;
            margin: 0;
        }
        .container {
            background-color: #1e1e1e;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            text-align: center;
        }
        h1 {
            margin-top: 0;
            color: #bb86fc;
        }
        .controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        select, button {
            padding: 10px 15px;
            font-size: 16px;
            border-radius: 8px;
            border: 1px solid #333;
            background-color: #333;
            color: #ffffff;
            cursor: pointer;
        }
        button {
            background-color: #03dac6;
            color: #000000;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #018786;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Generador Musical 🎵</h1>
    <div class="controls">
        <label for="root-note">Nota Raíz:</label>
        <select id="root-note">
            <option value="C4">Do</option>
            <option value="C#4">Do#</option>
            <option value="D4">Re</option>
            <option value="D#4">Re#</option>
            <option value="E4">Mi</option>
            <option value="F4">Fa</option>
            <option value="F#4">Fa#</option>
            <option value="G4">Sol</option>
            <option value="G#4">Sol#</option>
            <option value="A4">La</option>
            <option value="A#4">La#</option>
            <option value="B4">Si</option>
        </select>

        <label for="music-type">Tipo:</label>
        <select id="music-type">
            <option value="major-chord">Acorde Mayor</option>
            <option value="minor-chord">Acorde Menor</option>
            <option value="major-scale">Escala Mayor</option>
            <option value="minor-scale">Escala Menor</option>
        </select>
    </div>
    <button id="play-button">Tocar</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
<script>
    // Inicializar el sintetizador
    const synth = new Tone.PolySynth(Tone.Synth).toDestination();

    // Notas de la escala cromática para facilitar los cálculos
    const chromaticScale = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];

    // Función para obtener una nota subiendo un número de semitonos desde una raíz
    function getNote(rootNote, semitones) {
        const octave = parseInt(rootNote.slice(-1));
        const noteName = rootNote.slice(0, -1);
        const rootIndex = chromaticScale.indexOf(noteName);
        
        const newIndex = (rootIndex + semitones) % 12;
        let newOctave = octave + Math.floor((rootIndex + semitones) / 12);
        
        return chromaticScale[newIndex] + newOctave;
    }

    document.getElementById('play-button').addEventListener('click', async () => {
        // Iniciar el contexto de audio (necesario para la mayoría de navegadores)
        await Tone.start();

        const rootNote = document.getElementById('root-note').value;
        const musicType = document.getElementById('music-type').value;

        let notesToPlay = [];

        switch(musicType) {
            case 'major-chord':
                // Tónica (0), Tercera Mayor (4), Quinta Justa (7)
                notesToPlay = [getNote(rootNote, 0), getNote(rootNote, 4), getNote(rootNote, 7)];
                synth.triggerAttackRelease(notesToPlay, "1s");
                break;
            
            case 'minor-chord':
                // Tónica (0), Tercera Menor (3), Quinta Justa (7)
                notesToPlay = [getNote(rootNote, 0), getNote(rootNote, 3), getNote(rootNote, 7)];
                synth.triggerAttackRelease(notesToPlay, "1s");
                break;

            case 'major-scale':
                // Patrón T-T-S-T-T-T-S (2-2-1-2-2-2-1 semitonos)
                const majorSteps = [0, 2, 4, 5, 7, 9, 11, 12];
                notesToPlay = majorSteps.map(step => getNote(rootNote, step));
                playSequence(notesToPlay);
                break;

            case 'minor-scale':
                // Patrón T-S-T-T-S-T-T (2-1-2-2-1-2-2 semitonos)
                const minorSteps = [0, 2, 3, 5, 7, 8, 10, 12];
                notesToPlay = minorSteps.map(step => getNote(rootNote, step));
                playSequence(notesToPlay);
                break;
        }
    });

    // Función para tocar las notas de una escala en secuencia
    function playSequence(notes) {
        const now = Tone.now();
        notes.forEach((note, index) => {
            synth.triggerAttackRelease(note, "8n", now + index * 0.3);
        });
    }

</script>

</body>
</html>
